<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام تسجيل التلاميذ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-user-graduate"></i> نظام تسجيل التلاميذ</h1>
            <div class="header-buttons">
                <button onclick="showFoujChoiceModal()" class="btn-register">
                    <i class="fas fa-plus-circle"></i> تسجيل طالب جديد
                </button>
                <button onclick="exportToExcel()" class="btn-export">
                    <i class="fas fa-file-excel"></i> تصدير إلى Excel
                </button>
            </div>
        </header>

        <main>
            <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" onkeyup="filterStudents()" placeholder="ابحث عن طالب بالاسم، اللقب، أو رقم الهاتف...">
            </div>

            <div class="student-list-container">
                <table id="studentTable">
                    <thead>
                        <tr>
                            <th>الرقم</th>
                            <th>الاسم واللقب</th>
                            <th>تاريخ الميلاد</th>
                            <th>المستوى الدراسي</th>
                            <th>هاتف ولي الأمر</th>
                            <th>الفوج</th>
                            <th>إجراءات</th>
                        </tr>
                    </thead>
                    <tbody id="studentList">
                        </tbody>
                </table>
            </div>
             <p id="studentCount">عدد التلاميذ المسجلين: 0</p>
        </main>
    </div>

    <div id="foujChoiceModal" class="modal" style="display:none;">
      <div class="modal-content">
        <h3>الخطوة 1: اختر الفوج</h3>
        <p>الرجاء تحديد الفوج الذي تريد تسجيل الطالب فيه.</p>
        <form id="foujChoiceForm">
            <div id="foujList" class="radio-group">
                </div>
            <div class="consent-buttons" style="justify-content:center; margin-top:20px; gap: 15px;">
                <button type="submit" class="btn-yes">التالي</button>
                <button type="button" class="btn-no" onclick="closeFoujChoiceModal()">إلغاء</button>
            </div>
        </form>
      </div>
    </div>

    <div id="registrationModal" class="modal" style="display:none;">
        <div class="modal-content">
            <span class="close-button" onclick="closeRegistrationModal()">&times;</span>
            <h2><i class="fas fa-user-plus"></i> تسجيل طالب جديد</h2>
            <form id="studentForm">
                <input type="text" id="firstName" placeholder="الاسم" required>
                <input type="text" id="lastName" placeholder="اللقب" required>
                <input type="date" id="dob" required>
                <select id="grade" required>
                    <option value="" disabled selected>اختر المستوى الدراسي</option>
                    <option value="الأولى متوسط">الأولى متوسط</option>
                    <option value="الثانية متوسط">الثانية متوسط</option>
                    <option value="الثالثة متوسط">الثالثة متوسط</option>
                    <option value="الرابعة متوسط">الرابعة متوسط</option>
                </select>
                <input type="tel" id="parentPhone" placeholder="رقم هاتف ولي الأمر" required>
                <div class="form-buttons">
                    <button type="submit" class="btn-confirm">
                        <i class="fas fa-check-circle"></i> تأكيد التسجيل
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="editStudentModal" class="modal" style="display:none;">
        <div class="modal-content">
            <span class="close-button" onclick="closeEditModal()">&times;</span>
            <h2><i class="fas fa-edit"></i> تعديل بيانات الطالب</h2>
            <form id="editStudentForm">
                <input type="hidden" id="editStudentUID">
                <input type="text" id="editFirstName" placeholder="الاسم" required>
                <input type="text" id="editLastName" placeholder="اللقب" required>
                <input type="date" id="editDob" required>
                <select id="editGrade" required>
                     <option value="الأولى متوسط">الأولى متوسط</option>
                     <option value="الثانية متوسط">الثانية متوسط</option>
                     <option value="الثالثة متوسط">الثالثة متوسط</option>
                     <option value="الرابعة متوسط">الرابعة متوسط</option>
                </select>
                <input type="tel" id="editParentPhone" placeholder="رقم هاتف ولي الأمر" required>
                
                <input type="hidden" name="editLocation">
                <input type="hidden" name="editSchedule">

                <div class="form-buttons" style="display: flex; justify-content: space-between; align-items: center; margin-top: 30px;">
                    <button type="submit" class="btn-confirm">
                        <i class="fas fa-save"></i> حفظ التعديلات
                    </button>
                    <button type="button" class="btn-edit" onclick="showEditFoujChangeModal()" style="background: #3498db;">
                        <i class="fas fa-exchange-alt"></i> تغيير الفوج
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="editFoujChangeModal" class="modal" style="display:none;">
      <div class="modal-content">
        <h3>تغيير الفوج للطالب</h3>
        <form id="editChangeFoujForm">
          <label>اختر فوجاً جديداً:</label>
          <div id="editFoujChoicesList" class="radio-group">
            </div>
          <div class="consent-buttons" style="justify-content:center; margin-top:20px; gap: 15px;">
            <button type="submit" class="btn-yes">تأكيد الفوج الجديد</button>
            <button type="button" class="btn-no" onclick="closeEditFoujChangeModal()">إلغاء</button>
          </div>
        </form>
      </div>
    </div>

    <div id="confirmationModal" class="modal" style="display:none;">
        <div class="modal-content">
            <h3>تأكيد الإجراء</h3>
            <p id="confirmationMessage">هل أنت متأكد من أنك تريد المتابعة؟</p>
            <div class="consent-buttons">
                <button id="confirmBtn" class="btn-yes">نعم</button>
                <button id="cancelBtn" class="btn-no">لا</button>
            </div>
        </div>
    </div>
    
    <div id="customAlert" class="custom-alert" style="display:none;"></div>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
